<template>
  <div
    class="login-app"
    v-loading="loginLoading"
    element-loading-text="授权登录中..."
    element-loading-spinner="el-icon-loading"
  >
    <el-container class="login-container">
      <el-form ref="form" :model="form" label-width="40px" class="login-form">
        <h1>GO-IM</h1>
        <el-form-item label="账号">
          <el-input type="text" v-model="form.name"></el-input>
        </el-form-item>
        <el-form-item label="密码">
          <el-input type="password" v-model="form.password"></el-input>
        </el-form-item>
        <p>第三方登录</p>
        <el-form-item label="">
          <el-row>
            <el-col class="item-center" :span="8">
              <svg
                @click="weiboLogin"
                t="1624525865244"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="5135"
                width="30"
                height="30"
              >
                <path
                  d="M357.741904 600.362884c-25.69135 2.681895-44.090113 25.079456-44.090113 46.493689 0 21.467441 20.683644 36.29512 46.389319 33.291929 25.598235-2.921332 46.374994-22.71681 46.374994-44.104439C406.416104 614.548995 387.233544 597.545922 357.741904 600.362884z"
                  p-id="5136"
                  fill="#d81e06"
                ></path>
                <path
                  d="M422.943374 582.668105c-8.807995 6.375769-10.615026 18.598294-5.81913 26.195804 4.596365 7.759181 15.304505 8.660649 23.990735 2.179488 8.503071-6.696041 11.810162-18.387508 7.200495-26.198874C443.719109 577.247014 433.145013 575.042968 422.943374 582.668105z"
                  p-id="5137"
                  fill="#d81e06"
                ></path>
                <path
                  d="M512.319761 1.023234c-282.373596 0-511.741644 229.076426-511.741644 511.634204 0 282.453408 229.368048 511.342583 511.741644 511.342583 282.598707 0 511.621925-228.889175 511.621925-511.342583C1023.941686 230.09966 794.918468 1.023234 512.319761 1.023234zM791.997136 640.932051C735.590359 760.730196 549.621742 819.021769 411.837196 808.23484c-130.984136-10.307032-299.377692-53.801624-316.779826-212.284139 0 0-9.192731-71.789047 60.391248-164.673079 0 0 100.084527-139.805433 216.694276-179.683916 116.677283-39.720906 130.267872 27.499403 130.267872 67.191659-6.191587 33.689967-17.788916 53.484421 26.009575 39.88053 0 0 114.685047-53.190753 161.871466-6.005358 38.098057 38.126708 6.295956 90.493758 6.295956 90.493758s-15.807936 17.50855 16.711451 23.833157C745.871811 473.469637 848.375262 520.947677 791.997136 640.932051zM678.891961 309.96509c-12.48652 0-22.489652-10.097269-22.489652-22.478396 0-12.592936 10.002109-22.689182 22.489652-22.689182 0 0 140.576951-26.010599 123.785687 125.086217 0 0.902492-0.106416 1.594198-0.266041 2.391297-1.621825 10.680513-10.999761 18.890939-22.105939 18.890939-12.540751 0-22.690205-10.017457-22.690205-22.505C757.615463 388.660965 779.881026 287.699527 678.891961 309.96509zM916.391647 415.336665c-3.719454 54.413517-16.41983 35.363977-31.511503 35.363977-18.092817 0-32.679012-9.112919-32.679012-27.206759 0-15.70152 6.482185-28.853142 6.482185-28.853142 1.912424-6.615205 17.217952-46.229695-10.096246-107.524458-50.001334-83.983946-150.697754-84.515004-162.600008-79.705806-11.996391 4.676178-29.690147 7.439932-29.690147 7.439932-18.20128 0-32.787475-14.532987-32.787475-32.519388 0-15.091673 10.096246-27.60582 23.886366-31.510479 0 0 0.319249-0.053208 0.810401-0.159624 0.99663-0.211809 2.005538-0.371434 3.108584-0.476827 13.987604-2.710546 63.951078-21.840922 112.571047-10.468703 86.987136 20.298909 206.387244 112.385841 152.665433 275.624347L916.391647 415.339735z"
                  p-id="5138"
                  fill="#d81e06"
                ></path>
                <path
                  d="M422.038835 439.088987c-136.802242 6.270376-247.368774 79.546182-247.368774 170.943455 0 91.290857 110.566532 159.890485 247.368774 153.513693 136.883077-6.216144 247.673697-91.928332 247.673697-183.190538C669.713556 489.144553 558.921912 432.765403 422.038835 439.088987zM515.215512 668.934885c-41.886068 54.094268-124.78027 80.476301-205.269873 36.904967-38.286332-20.805409-36.903944-61.586385-36.903944-61.586385s-15.888772-128.912087 121.684988-144.986064C532.512253 483.246634 557.114882 614.840617 515.215512 668.934885z"
                  p-id="5139"
                  fill="#d81e06"
                ></path>
              </svg>
            </el-col>
            <el-col class="item-center" :span="8">
              <svg
                t="1624525783975"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="3988"
                width="30"
                height="30"
              >
                <path
                  d="M787.696941 669.515294c0 44.935529-23.431529 118.181647-78.787765 118.181647-55.416471 0-78.848-73.246118-78.848-118.181647 0-44.875294 23.431529-118.181647 78.848-118.181647 55.356235 0 78.787765 73.306353 78.787765 118.181647zM315.090824 551.333647c-55.356235 0-78.787765 73.306353-78.787765 118.181647 0 44.935529 23.431529 118.181647 78.787765 118.181647s78.787765-73.246118 78.787764-118.181647c0-44.875294-23.431529-118.181647-78.787764-118.181647zM1024 561.212235c0 68.367059-6.746353 140.950588-37.526588 203.715765-81.257412 164.321882-304.609882 180.284235-464.594824 180.284235-162.454588 0-399.36-14.095059-483.689412-180.284235C6.746353 702.765176 0 629.579294 0 561.212235c0-89.871059 24.636235-174.742588 83.727059-243.651764a338.160941 338.160941 0 0 1-16.624941-104.688942c0-46.140235 10.420706-92.220235 31.382588-134.144 97.219765 0 159.382588 42.465882 233.231059 100.291765a823.536941 823.536941 0 0 1 190.162823-21.504c57.825882 0 116.314353 6.204235 172.333177 19.696941 73.246118-57.223529 135.348706-98.484706 231.363764-98.484706 20.961882 41.863529 31.382588 88.003765 31.382589 134.144 0 35.117176-5.541647 70.174118-16.624942 103.424C999.424 385.807059 1024 471.341176 1024 561.212235z m-137.878588 108.303059c0-94.147765-57.163294-177.212235-157.515294-177.212235-40.598588 0-79.329882 7.408941-119.988706 12.950588-31.984941 4.939294-63.969882 6.746353-96.617412 6.746353s-64.632471-1.807059-96.617412-6.746353c-39.996235-5.541647-79.390118-12.950588-119.988706-12.950588-100.291765 0-157.515294 83.064471-157.515294 177.212235 0 188.295529 172.272941 217.208471 322.43953 217.208471h103.424c150.166588 0.060235 322.379294-28.912941 322.379294-217.208471z"
                  p-id="3989"
                ></path>
              </svg>
            </el-col>
            <el-col class="item-center" :span="8">
              <svg
                t="1624525807281"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="4226"
                width="30"
                height="30"
              >
                <path
                  d="M512 1024C230.4 1024 0 793.6 0 512S230.4 0 512 0s512 230.4 512 512-230.4 512-512 512z m259.2-569.6H480c-12.8 0-25.6 12.8-25.6 25.6v64c0 12.8 12.8 25.6 25.6 25.6h176c12.8 0 25.6 12.8 25.6 25.6v12.8c0 41.6-35.2 76.8-76.8 76.8h-240c-12.8 0-25.6-12.8-25.6-25.6V416c0-41.6 35.2-76.8 76.8-76.8h355.2c12.8 0 25.6-12.8 25.6-25.6v-64c0-12.8-12.8-25.6-25.6-25.6H416c-105.6 0-188.8 86.4-188.8 188.8V768c0 12.8 12.8 25.6 25.6 25.6h374.4c92.8 0 169.6-76.8 169.6-169.6v-144c0-12.8-12.8-25.6-25.6-25.6z"
                  fill="#d81e06"
                  p-id="4227"
                ></path>
              </svg>
            </el-col>
          </el-row>
        </el-form-item>
        <el-form-item class="login-btn">
          <el-button @click="login" type="login">登录</el-button>
          <el-button @click="registered">注册</el-button>
        </el-form-item>
      </el-form>
    </el-container>
    <div class="footer" style="">
      <p>由latent编码🔧 2021-{{ year }} 「web-im-app📦」</p>
      <p>
        <a target="_black" href="https://github.com/pl1998/web-im-app">
          源码
        </a>
      </p>
      <p>
        <a
          href="https://baike.baidu.com/item/MIT%E8%AE%B8%E5%8F%AF%E8%AF%81/6671281?fr=aladdin"
          target="_black"
          >基于MIT开源</a
        >
      </p>
    </div>
  </div>
</template>
<script>
// import { mapState } from "vuex";
export default {
  data() {
    return {
      loginLoading: false,
      form: {
        name: "",
        password: "",
      },
    };
  },
  watch: {
    "this.$store.auth"() {
      this.$route.push({ path: "/" });
    },
  },
  created() {
    if (this.$route.query.code) {
      this.auth(this.$route.query.code);
    } else {
    }
  },
  methods: {
    login() {
      this.$notify({
        title: "提醒⏰",
        message: "请使用第三方登录",
        type: "warning",
      });
    },
    registered() {
      this.$notify({
        title: "提醒⏰",
        message: "暂未开放用户注册",
        type: "warning",
      });
    },
    weiboLogin() {
      window.location.href =
        "https://api.weibo.com/oauth2/authorize?client_id=1949419161&redirect_uri=http://127.0.0.1:3002/login";
      // window.open(
      //   "https://api.weibo.com/oauth2/authorize?client_id=" +
      //     import.meta.env.VITE_APP_WB_CLIENT_ID +
      //     "&redirect_uri=" +
      //     import.meta.env.VITE_APP_WB_REDIRECT_URL
      // );
    },
    onSubmit() {
      console.log("submit!");
    },
    auth(code) {
      this.loginLoading = true;
      this.$store.dispatch("weiboLogin", { code: code });
      //http://127.0.0.1:9502/api/WeiBoCallBack 请求该接口
    },
  },
};
</script>
<style lang="scss" scoped>

.login-app {
  background-color: aliceblue;
  text-align: center; 
  border-radius: 20px;
  width:400px;
  height: 350px;
  margin: auto;
  position: relative;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}
@media screen and (max-width: 750px) {
  .login-app {
    width: 90%;
  }
}


.el-container {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
  flex-direction: row;
  -webkit-box-flex: 1;
  flex: 1 1 auto;
  box-sizing: border-box;
  min-width: 0px;
  justify-content: center;
}

.login-form {
  width: 80%;
}

.el-button--login.is-active,
.el-button--login:active {
  opacity: 0.8;
  color: #fff;
}
.el-button--login:focus,
.el-button--login:hover {
  opacity: 0.8;
  color: #fff;
}
.el-button--login {
  opacity: 0.8;
  background-color: #5c6bc6;
  border: 1px solid hsla(0, 0%, 100%, 0.6);
  color: #fff;
  transition: left 0.3s ease;
  text-transform: uppercase;
  border-radius: 3px;
}
.footer {
  color: #fff;
  margin: auto;
  position: relative;
  top: 30px;
  left: 0;
  right: 0;
  bottom: 0;
}
.footer a {
  color: #fff;
}
</style>